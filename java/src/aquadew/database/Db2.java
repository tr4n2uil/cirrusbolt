package aquadew.database;import java.sql.Connection;import java.sql.DriverManager;import java.sql.SQLException;import java.sql.PreparedStatement;import java.sql.ResultSet;import aquadew.core.ADException;/** *	@class Db2 *	@desc Concrete class for DB2 JDBC database services  * *	@author Vibhaj Rajan <vibhaj8@gmail.com> ***/public class Db2 extends JDBC implements DataService {		/** 	 *	@constructor 	**/	public Db2(String url, String user, String pass) throws ADException {		super(url, user, pass, "com.ibm.db2.jcc.DB2Driver");	}		/** 	 *	@interface DataService	**/	public long getAutoId() throws ADException {		String query = "select identity_val_local() as lastid from sysibm.sysdummy1;";		PreparedStatement ps;		Result Set rs;		long result = -1.0;				try {			ps = this.conn.prepareStatement(query);			rs = ps.executeQuery();			if(rs.next())				result = rs.getLong(1);		} catch(Exception e) {			throw new ADException("Exception Occured : " + e.getMessage());		} finally {			if(rs != null) 				rs.close();			if(ps != null) 				ps.close();		}				return result;	}	}